# Tutorial 1. Assessing the adequacy of phylodynamic models in Ebola

## Requirements

In this tutorial we will assess the adequacy of models that describe branching process of phylogenetic trees. We will focus on the Birth-Death Skyline, Coalescent Exponential, and Constant-size coalescent. To do this, we will use the Tree Model Adequacy (TMA) package in BEAST2. To install please follow the instructions [here](https://github.com/sebastianduchene/tree_model_adequacy/wiki). We will also use [FigTree](http://beast.bio.ed.ac.uk/figtree), [Tracer](http://beast.bio.ed.ac.uk/tracer), and [R](https://www.r-project.org/) to visualise the results.

## Background

The TMA package is used to assess the adequacy of tree branching models. Model adequacy differs from model selection methods in that the goal is not to select the best model from a set of competing models, but to determine whether the data at hand could have been generated by a given model. In this respect, the model is treated as a hypothesis that can be rejected on some statistical grounds. In the context of branching models, we can use model adequacy to determine whether the tree shape that we observe in an empirical tree could have been generated by a constant Birth-Death process. This is important to interpret the inferences from the model and to obtain better insight about the biological process that generated the data. For the purpose of tree model adequacy, we will treat the phylogenetic tree with branch lengths in units of time (i.e. a chronogram) as the "empirical data".

Bayesian model adequacy consists of analysing the data under the model in question to estimate the posterior. The posterior is then used to simulate data sets, which represent hypothetical future observations under the model, and which are known as *posterior predictive simulations*. The model is considered adequate if the posterior predictive simulations are similar to the empirical data according to some test statistic. The choice of test statistic can be driven by some expectation about the model. For example, the exponential-growth coalescent model typically generates trees with long external branches (for population sizes that are increasing exponentially), such that the ratio of external to internal branch lengths is a useful test statistic. Similarly, the Birth-Death model with sampling explicitly models the sampling process through time, so we could also use the sampling times (i.e. ages of the tips) as a test statistic. The values of the test statistic from the posterior predictive simulations represent the expectation of values under the model, which is known as the *posterior predictive distribution*. The posterior predictive model adequacy framework is outlined in Fig. 1.

## Obtaining the data

We will use a tree that was estimated for Ebola samples collected in West Africa at the early stages of the 2013-2015 outbreak. Please download the tree [here]().

Open the tree in FigTree by double-clicking on it. Otherwise, open FigTree and go to **File**, **Open**, and find the tree. The display should look like Fig 2.

Fig2. Ebola tree for West African samples collected in 2014. The branch lengths and scale bar are in units of years.
